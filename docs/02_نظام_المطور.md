  failureCount  Int      @default(0) @map("failure_count")
  
  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")
  
  deliveries    dev_webhook_deliveries[]
  
  @@map("dev_webhooks")
}

// تسليمات Webhook
model dev_webhook_deliveries {
  id            String   @id @default(uuid()) @db.Uuid
  webhookId     String   @map("webhook_id") @db.Uuid
  eventId       String   @map("event_id") @db.Uuid
  
  requestBody   Json     @map("request_body")
  responseBody  Json?    @map("response_body")
  statusCode    Int?     @map("status_code")
  
  duration      Int?
  error         String?  @db.Text
  
  createdAt     DateTime @default(now()) @map("created_at")
  
  webhook       dev_webhooks @relation(fields: [webhookId], references: [id])
  
  @@index([webhookId])
  @@index([createdAt])
  @@map("dev_webhook_deliveries")
}

// نماذج الذكاء الاصطناعي
model dev_ai_models {
  id            String   @id @default(uuid()) @db.Uuid
  code          String   @unique @db.VarChar(50)
  name          String   @db.VarChar(200)
  type          String   @db.VarChar(50) // prediction, classification, anomaly_detection
  
  provider      String   @db.VarChar(50) // openai, local, custom
  modelVersion  String?  @map("model_version") @db.VarChar(50)
  
  config        Json     @default("{}")
  metrics       Json     @default("{}")
  
  isActive      Boolean  @default(true) @map("is_active")
  lastTrainedAt DateTime? @map("last_trained_at")
  
  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")
  
  predictions   dev_ai_predictions[]
  
  @@map("dev_ai_models")
}

// تنبؤات الذكاء الاصطناعي
model dev_ai_predictions {
  id            String   @id @default(uuid()) @db.Uuid
  modelId       String   @map("model_id") @db.Uuid
  
  inputData     Json     @map("input_data")
  prediction    Json
  confidence    Decimal? @db.Decimal(5, 4)
  
  actualValue   Json?    @map("actual_value")
  feedback      String?  @db.VarChar(50)
  
  createdAt     DateTime @default(now()) @map("created_at")
  
  model         dev_ai_models @relation(fields: [modelId], references: [id])
  
  @@index([modelId])
  @@index([createdAt])
  @@map("dev_ai_predictions")
}

// مقاييس الأداء
model dev_metrics {
  id            String   @id @default(uuid()) @db.Uuid
  systemId      String   @map("system_id") @db.VarChar(50)
  metricType    String   @map("metric_type") @db.VarChar(50)
  
  value         Decimal  @db.Decimal(15, 4)
  unit          String?  @db.VarChar(20)
  tags          Json     @default("{}")
  
  timestamp     DateTime @default(now())
  
  @@index([systemId])
  @@index([metricType])
  @@index([timestamp])
  @@map("dev_metrics")
}

// التنبيهات
model dev_alerts {
  id            String   @id @default(uuid()) @db.Uuid
  code          String   @db.VarChar(50)
  title         String   @db.VarChar(200)
  message       String   @db.Text
  
  severity      String   @db.VarChar(20) // info, warning, error, critical
  sourceSystem  String   @map("source_system") @db.VarChar(50)
  
  metadata      Json     @default("{}")
  
  status        String   @default("active") @db.VarChar(20)
  acknowledgedBy String? @map("acknowledged_by") @db.Uuid
  acknowledgedAt DateTime? @map("acknowledged_at")
  resolvedAt    DateTime? @map("resolved_at")
  
  createdAt     DateTime @default(now()) @map("created_at")
  
  @@index([severity])
  @@index([sourceSystem])
  @@index([status])
  @@map("dev_alerts")
}
```

### NestJS Modules

```typescript
// src/app.module.ts
import { Module } from '@nestjs/common';
import { ConfigModule } from '@nestjs/config';
import { EventEmitterModule } from '@nestjs/event-emitter';
import { HttpModule } from '@nestjs/axios';
import { ScheduleModule } from '@nestjs/schedule';

import { PrismaModule } from './prisma/prisma.module';
import { IntegrationsModule } from './modules/integrations/integrations.module';
import { ApiKeysModule } from './modules/api-keys/api-keys.module';
import { WebhooksModule } from './modules/webhooks/webhooks.module';
import { EventsModule } from './modules/events/events.module';
import { AiModule } from './modules/ai/ai.module';
import { MonitoringModule } from './modules/monitoring/monitoring.module';

@Module({
  imports: [
    ConfigModule.forRoot({ isGlobal: true }),
    EventEmitterModule.forRoot(),
    ScheduleModule.forRoot(),
    HttpModule,
    PrismaModule,
    IntegrationsModule,
    ApiKeysModule,
    WebhooksModule,
    EventsModule,
    AiModule,
    MonitoringModule,
  ],
})
export class AppModule {}
```

### Environment Variables

```env
# .env
DATABASE_URL="postgresql://postgres:postgres@localhost:5432/electricity_management"

JWT_SECRET="developer-system-secret-key"
API_PORT=3002
API_PREFIX="api/v1"

# OpenAI للذكاء الاصطناعي
OPENAI_API_KEY="sk-..."

# URLs الأنظمة الأخرى
CORE_API_URL="http://localhost:3001/api/v1"
ASSETS_API_URL="http://localhost:3003/api/v1"
FIELD_OPS_API_URL="http://localhost:3004/api/v1"
SCADA_API_URL="http://localhost:3005/api/v1"
INVENTORY_API_URL="http://localhost:3006/api/v1"
BILLING_API_URL="http://localhost:3007/api/v1"
HR_API_URL="http://localhost:3008/api/v1"
REPORTS_API_URL="http://localhost:3009/api/v1"
PROJECTS_API_URL="http://localhost:3010/api/v1"
```
